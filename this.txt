Legacy migration - connection test with credentialspackages/backend/scripts/legacy-migration/test-mysql-connection.ts# Apple Auth Keys (NEVER commit these!)AuthKey*.p8*.p8# Firebase/Google service files (contain API keys)# Note: GoogleService-Info.plist is needed for builds but keys are restricted by bundle ID# google-services.json is needed for Android builds# Security alert trackinggitissues.txt
Collapse fileâ€ŽAuthKey_4VH2CWJWHX.p8â€ŽCopy file name to clipboardExpand all lines: AuthKey_4VH2CWJWHX.p8-6Lines changed: 0 additions & 6 deletions Load DiffThis file was deleted.
Collapse fileâ€Žclean-import-to-render.jsâ€ŽCopy file name to clipboardExpand all lines: clean-import-to-render.js+9-1Lines changed: 9 additions & 1 deletionOriginal file line numberDiff line numberDiff line change@@ -2,7 +2,15 @@ const { Client } = require('pg');const fs = require('fs');const path = require('path');const RENDER_URL = 'postgresql://fightcrewappdb_k127_user:DLeYZBwCclr4JOEKDndStpQT0hBGNRlL@dpg-d3oee81r0fns73c59610-a.oregon-postgres.render.com/fightcrewappdb_k127';// Use environment variable for database URL - NEVER hardcode credentials!// Usage: DATABASE_URL="postgresql://..." node clean-import-to-render.jsconst RENDER_URL = process.env.DATABASE_URL;if (!RENDER_URL) {  console.error('ERROR: DATABASE_URL environment variable is required');  console.error('Usage: DATABASE_URL="postgresql://user:pass@host/db" node clean-import-to-render.js');  process.exit(1);}// Tables in correct deletion order (children first, then parents)const TABLES_TO_TRUNCATE = [
Collapse fileâ€Žpackages/backend/check-render-production.tsâ€ŽCopy file name to clipboardExpand all lines: packages/backend/check-render-production.ts+7-2Lines changed: 7 additions & 2 deletionsOriginal file line numberDiff line numberDiff line change@@ -1,7 +1,12 @@import { PrismaClient } from '@prisma/client';// Connect to Render production databaseprocess.env.DATABASE_URL = 'postgresql://fightcrewapp_user:WjU2ZdAJESuMaMumbyRGgIV1HXJWg8KU@dpg-d3oee81r0fns73c59610-a.oregon-postgres.render.com/fightcrewapp';// Use environment variable for database URL - NEVER hardcode credentials!// Usage: DATABASE_URL="postgresql://..." npx ts-node check-render-production.tsif (!process.env.DATABASE_URL) {  console.error('ERROR: DATABASE_URL environment variable is required');  console.error('Usage: DATABASE_URL="postgresql://user:pass@host/db" npx ts-node check-render-production.ts');  process.exit(1);}const prisma = new PrismaClient();
Collapse fileâ€Žpackages/backend/scripts/fast-sync-ratings.jsâ€ŽCopy file name to clipboardExpand all lines: packages/backend/scripts/fast-sync-ratings.js+11-2Lines changed: 11 additions & 2 deletionsOriginal file line numberDiff line numberDiff line change@@ -1,10 +1,19 @@/** * Fast sync ratings using batch inserts * * Usage: LOCAL_DATABASE_URL="..." RENDER_DATABASE_URL="..." node fast-sync-ratings.js */const { PrismaClient } = require('@prisma/client');const LOCAL_URL = 'postgresql://dev:devpassword@localhost:5433/yourapp_dev';const RENDER_URL = 'postgresql://fightcrewappdb_k127_user:DLeYZBwCclr4JOEKDndStpQT0hBGNRlL@dpg-d3oee81r0fns73c59610-a.oregon-postgres.render.com/fightcrewapp';// Use environment variables - NEVER hardcode credentials!const LOCAL_URL = process.env.LOCAL_DATABASE_URL || 'postgresql://dev:devpassword@localhost:5433/yourapp_dev';const RENDER_URL = process.env.RENDER_DATABASE_URL;if (!RENDER_URL) {  console.error('ERROR: RENDER_DATABASE_URL environment variable is required');  console.error('Usage: LOCAL_DATABASE_URL="..." RENDER_DATABASE_URL="..." node fast-sync-ratings.js');  process.exit(1);}const localDb = new PrismaClient({ datasources: { db: { url: LOCAL_URL } } });const renderDb = new PrismaClient({ datasources: { db: { url: RENDER_URL } } });
Collapse fileâ€Žpackages/backend/scripts/legacy-migration/launch-day-reset.jsâ€ŽCopy file name to clipboardExpand all lines: packages/backend/scripts/legacy-migration/launch-day-reset.js+9-1Lines changed: 9 additions & 1 deletionOriginal file line numberDiff line numberDiff line change@@ -25,7 +25,15 @@ const { execSync } = require('child_process');const path = require('path');const { PrismaClient } = require('@prisma/client');const PRODUCTION_DB_URL = 'postgresql://fightcrewappdb_k127_user:DLeYZBwCclr4JOEKDndStpQT0hBGNRlL@dpg-d3oee81r0fns73c59610-a.oregon-postgres.render.com/fightcrewapp-db';// Use environment variable - NEVER hardcode credentials!// Usage: PRODUCTION_DATABASE_URL="postgresql://..." node launch-day-reset.js --executeconst PRODUCTION_DB_URL = process.env.PRODUCTION_DATABASE_URL;if (!PRODUCTION_DB_URL) {  console.error('ERROR: PRODUCTION_DATABASE_URL environment variable is required');  console.error('Usage: PRODUCTION_DATABASE_URL="postgresql://..." node launch-day-reset.js --execute');  process.exit(1);}const MYSQL_EXPORT_DIR = path.join(__dirname, 'mysql-export');
Collapse fileâ€Žpackages/backend/scripts/sync-to-render.jsâ€ŽCopy file name to clipboardExpand all lines: packages/backend/scripts/sync-to-render.js+11-3Lines changed: 11 additions & 3 deletionsOriginal file line numberDiff line numberDiff line change@@ -1,12 +1,20 @@/** * Sync local database to Render production database * Run with: node scripts/sync-to-render.js * * Usage: LOCAL_DATABASE_URL="..." RENDER_DATABASE_URL="..." node scripts/sync-to-render.js */const { PrismaClient } = require('@prisma/client');const LOCAL_URL = 'postgresql://dev:devpassword@localhost:5433/yourapp_dev';const RENDER_URL = 'postgresql://fightcrewappdb_k127_user:DLeYZBwCclr4JOEKDndStpQT0hBGNRlL@dpg-d3oee81r0fns73c59610-a.oregon-postgres.render.com/fightcrewapp-db';// Use environment variables - NEVER hardcode credentials!const LOCAL_URL = process.env.LOCAL_DATABASE_URL || 'postgresql://dev:devpassword@localhost:5433/yourapp_dev';const RENDER_URL = process.env.RENDER_DATABASE_URL;if (!RENDER_URL) {  console.error('ERROR: RENDER_DATABASE_URL environment variable is required');  console.error('Usage: LOCAL_DATABASE_URL="..." RENDER_DATABASE_URL="..." node scripts/sync-to-render.js');  process.exit(1);}const localDb = new PrismaClient({ datasources: { db: { url: LOCAL_URL } } });const renderDb = new PrismaClient({ datasources: { db: { url: RENDER_URL } } });
Collapse fileâ€Žpackages/backend/scripts/sync-via-sql.jsâ€ŽCopy file name to clipboardExpand all lines: packages/backend/scripts/sync-via-sql.js+11-2Lines changed: 11 additions & 2 deletionsOriginal file line numberDiff line numberDiff line change@@ -1,10 +1,19 @@/** * Sync via raw SQL - only syncs records where FKs exist * * Usage: LOCAL_DATABASE_URL="postgresql://..." RENDER_DATABASE_URL="postgresql://..." node sync-via-sql.js */const { PrismaClient } = require('@prisma/client');const LOCAL_URL = 'postgresql://dev:devpassword@localhost:5433/yourapp_dev';const RENDER_URL = 'postgresql://fightcrewappdb_k127_user:DLeYZBwCclr4JOEKDndStpQT0hBGNRlL@dpg-d3oee81r0fns73c59610-a.oregon-postgres.render.com/fightcrewapp';// Use environment variables - NEVER hardcode credentials!const LOCAL_URL = process.env.LOCAL_DATABASE_URL || 'postgresql://dev:devpassword@localhost:5433/yourapp_dev';const RENDER_URL = process.env.RENDER_DATABASE_URL;if (!RENDER_URL) {  console.error('ERROR: RENDER_DATABASE_URL environment variable is required');  console.error('Usage: LOCAL_DATABASE_URL="..." RENDER_DATABASE_URL="..." node sync-via-sql.js');  process.exit(1);}const localDb = new PrismaClient({ datasources: { db: { url: LOCAL_URL } } });const renderDb = new PrismaClient({ datasources: { db: { url: RENDER_URL } } });
Collapse fileâ€Žpackages/backend/src/scripts/fixMigrationState.tsâ€ŽCopy file name to clipboardExpand all lines: packages/backend/src/scripts/fixMigrationState.ts+8-2Lines changed: 8 additions & 2 deletionsOriginal file line numberDiff line numberDiff line change@@ -1,12 +1,18 @@/** * Fix migration state in production database * Since we manually added the column, we need to mark the migration as completed * * Usage: DATABASE_URL="postgresql://..." npx ts-node fixMigrationState.ts */import { PrismaClient } from '@prisma/client';// Override DATABASE_URL to productionprocess.env.DATABASE_URL = 'postgresql://fightcrewapp_user:WjU2ZdAJESuMaMumbyRGgIV1HXJWg8KU@dpg-d3oee81r0fns73c59610-a.oregon-postgres.render.com/fightcrewapp';// Use environment variable - NEVER hardcode credentials!if (!process.env.DATABASE_URL) {  console.error('ERROR: DATABASE_URL environment variable is required');  console.error('Usage: DATABASE_URL="postgresql://..." npx ts-node fixMigrationState.ts');  process.exit(1);}const prisma = new PrismaClient();
Collapse fileâ€Žpackages/backend/src/scripts/importToProduction.tsâ€ŽCopy file name to clipboardExpand all lines: packages/backend/src/scripts/importToProduction.ts+8-3Lines changed: 8 additions & 3 deletionsOriginal file line numberDiff line numberDiff line change@@ -1,13 +1,18 @@/** * Import scraped UFC data directly to production database * Run with: npx ts-node src/scripts/importToProduction.ts * * Usage: DATABASE_URL="postgresql://..." npx ts-node src/scripts/importToProduction.ts */import { importUFCData } from '../services/ufcDataParser';import * as path from 'path';// Override DATABASE_URL to productionprocess.env.DATABASE_URL = 'postgresql://fightcrewapp_user:WjU2ZdAJESuMaMumbyRGgIV1HXJWg8KU@dpg-d3oee81r0fns73c59610-a.oregon-postgres.render.com/fightcrewapp';// Use environment variable - NEVER hardcode credentials!if (!process.env.DATABASE_URL) {  console.error('ERROR: DATABASE_URL environment variable is required');  console.error('Usage: DATABASE_URL="postgresql://..." npx ts-node src/scripts/importToProduction.ts');  process.exit(1);}// Override BASE_URL to production for image URLsprocess.env.BASE_URL = 'https://fightcrewapp-backend.onrender.com';
Collapse fileâ€Žpackages/backend/src/scripts/manuallyAddColumn.tsâ€ŽCopy file name to clipboardExpand all lines: packages/backend/src/scripts/manuallyAddColumn.ts+8-2Lines changed: 8 additions & 2 deletionsOriginal file line numberDiff line numberDiff line change@@ -1,12 +1,18 @@/** * Manually add cardType column using direct SQL * Then mark migration as applied * * Usage: DATABASE_URL="postgresql://..." npx ts-node manuallyAddColumn.ts */import { PrismaClient } from '@prisma/client';// Override DATABASE_URL to productionprocess.env.DATABASE_URL = 'postgresql://fightcrewapp_user:WjU2ZdAJESuMaMumbyRGgIV1HXJWg8KU@dpg-d3oee81r0fns73c59610-a.oregon-postgres.render.com/fightcrewapp';// Use environment variable - NEVER hardcode credentials!if (!process.env.DATABASE_URL) {  console.error('ERROR: DATABASE_URL environment variable is required');  console.error('Usage: DATABASE_URL="postgresql://..." npx ts-node manuallyAddColumn.ts');  process.exit(1);}const prisma = new PrismaClient();
Collapse fileâ€Žpackages/backend/src/scripts/markRolledBack.tsâ€ŽCopy file name to clipboardExpand all lines: packages/backend/src/scripts/markRolledBack.ts+9-2Lines changed: 9 additions & 2 deletionsOriginal file line numberDiff line numberDiff line change@@ -1,14 +1,21 @@/** * Mark failed migration as rolled back on production database * * Usage: DATABASE_URL="postgresql://..." npx ts-node markRolledBack.ts */import { exec } from 'child_process';import { promisify } from 'util';const execAsync = promisify(exec);// Override DATABASE_URL to productionconst prodDbUrl = 'postgresql://fightcrewapp_user:WjU2ZdAJESuMaMumbyRGgIV1HXJWg8KU@dpg-d3oee81r0fns73c59610-a.oregon-postgres.render.com/fightcrewapp';// Use environment variable - NEVER hardcode credentials!if (!process.env.DATABASE_URL) {  console.error('ERROR: DATABASE_URL environment variable is required');  console.error('Usage: DATABASE_URL="postgresql://..." npx ts-node markRolledBack.ts');  process.exit(1);}const prodDbUrl = process.env.DATABASE_URL;async function main() {  console.log('ðŸš€ Marking failed migration as rolled back on PRODUCTION...\n');
Collapse fileâ€Žpackages/backend/src/scripts/releaseLocks.tsâ€ŽCopy file name to clipboardExpand all lines: packages/backend/src/scripts/releaseLocks.ts+8-2Lines changed: 8 additions & 2 deletionsOriginal file line numberDiff line numberDiff line change@@ -1,11 +1,17 @@/** * Release all Prisma advisory locks on production database * * Usage: DATABASE_URL="postgresql://..." npx ts-node releaseLocks.ts */import { PrismaClient } from '@prisma/client';// Override DATABASE_URL to productionprocess.env.DATABASE_URL = 'postgresql://fightcrewapp_user:WjU2ZdAJESuMaMumbyRGgIV1HXJWg8KU@dpg-d3oee81r0fns73c59610-a.oregon-postgres.render.com/fightcrewapp';// Use environment variable - NEVER hardcode credentials!if (!process.env.DATABASE_URL) {  console.error('ERROR: DATABASE_URL environment variable is required');  console.error('Usage: DATABASE_URL="postgresql://..." npx ts-node releaseLocks.ts');  process.exit(1);}const prisma = new PrismaClient();
Collapse fileâ€Žpackages/backend/src/scripts/resolveMigration.tsâ€ŽCopy file name to clipboardExpand all lines: packages/backend/src/scripts/resolveMigration.ts+8-2Lines changed: 8 additions & 2 deletionsOriginal file line numberDiff line numberDiff line change@@ -1,15 +1,21 @@/** * Resolve failed Prisma migration on production * Marks the migration as rolled back and re-applies it * * Usage: DATABASE_URL="postgresql://..." npx ts-node resolveMigration.ts */import { exec } from 'child_process';import { promisify } from 'util';const execAsync = promisify(exec);// Override DATABASE_URL to productionprocess.env.DATABASE_URL = 'postgresql://fightcrewapp_user:WjU2ZdAJESuMaMumbyRGgIV1HXJWg8KU@dpg-d3oee81r0fns73c59610-a.oregon-postgres.render.com/fightcrewapp';// Use environment variable - NEVER hardcode credentials!if (!process.env.DATABASE_URL) {  console.error('ERROR: DATABASE_URL environment variable is required');  console.error('Usage: DATABASE_URL="postgresql://..." npx ts-node resolveMigration.ts');  process.exit(1);}async function main() {  console.log('ðŸš€ Resolving failed migration on PRODUCTION database...\n');
Collapse fileâ€Žpackages/backend/src/scripts/runProductionMigration.tsâ€ŽCopy file name to clipboardExpand all lines: packages/backend/src/scripts/runProductionMigration.ts+8-2Lines changed: 8 additions & 2 deletionsOriginal file line numberDiff line numberDiff line change@@ -1,15 +1,21 @@/** * Run Prisma migration directly on production database * This is a one-time script to add the cardType column * * Usage: DATABASE_URL="postgresql://..." npx ts-node runProductionMigration.ts */import { exec } from 'child_process';import { promisify } from 'util';const execAsync = promisify(exec);// Override DATABASE_URL to productionprocess.env.DATABASE_URL = 'postgresql://fightcrewapp_user:WjU2ZdAJESuMaMumbyRGgIV1HXJWg8KU@dpg-d3oee81r0fns73c59610-a.oregon-postgres.render.com/fightcrewapp';// Use environment variable - NEVER hardcode credentials!if (!process.env.DATABASE_URL) {  console.error('ERROR: DATABASE_URL environment variable is required');  console.error('Usage: DATABASE_URL="postgresql://..." npx ts-node runProductionMigration.ts');  process.exit(1);}async function main() {  console.log('ðŸš€ Running Prisma migration on PRODUCTION database...\n');